version: '3.8'

services:
  reactnative:
    image: reactnativecommunity/react-native-android
    volumes:
      - .:/app
    working_dir: /app
    entrypoint: >
      /bin/sh -c " 
      echo 'APP_ENV=${APP_ENV}' > .env &&
      echo 'URL=https://demo-sduf.gigalixirapp.com' >> .env &&
      echo 'SOCKET_URL=https://demo-sduf.gigalixirapp.com/socket' >> .env &&
      echo 'SOCKET_PROJECT_TOKEN=${SOCKET_PROJECT_TOKEN}' >> .env &&
      echo 'SOCKET_PROJECT_ID=${SOCKET_PROJECT_ID}' >> .env &&
      echo 'styleURL=${styleURL}' >> .env &&
      npx envinfo &&
      yarn install &&
      cd android &&
      chmod +x gradlew &&
      ./gradlew assembleRelease"